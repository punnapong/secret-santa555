<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body { font-family: sans-serif; text-align: center; }
input, button { font-size: 20px; padding: 10px; margin: 5px; }
</style>
</head>

<body>
<h2>‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
<input id="code" placeholder="‡πÄ‡∏ä‡πà‡∏ô A8F2K9">
<br>
<button onclick="draw()">‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å</button>
<p id="result"></p>

<script>
// üîß ‡πÉ‡∏™‡πà config ‡∏à‡∏≤‡∏Å Firebase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT"
});

const db = firebase.firestore();
const prizes = ["‡πÑ‡∏ö‡∏£‡πå‡∏ó", "‡πÄ‡∏ï‡∏¥‡∏£‡πå‡∏î", "‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î", "‡πÄ‡∏°‡∏¢‡πå"];

async function draw() {
  const code = document.getElementById("code").value.trim();
  const output = document.getElementById("result");

  if (!code) return;

  const ref = db.collection("users").doc(code);
  const snap = await ref.get();

  if (!snap.exists) {
    output.innerText = "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    return;
  }

  if (snap.data().used) {
    output.innerText = "‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß";
    return;
  }

  const prize = prizes[Math.floor(Math.random() * prizes.length)];

  await ref.update({
    used: true,
    result: prize
  });

  output.innerText = "üéÅ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ: " + prize;
}
</script>
</body>
</html>
