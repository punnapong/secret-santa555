<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  font-family: sans-serif;
  text-align: center;
  margin-top: 50px;
}
input, button {
  font-size: 22px;
  padding: 10px;
  margin: 8px;
}
#result {
  font-size: 26px;
  margin-top: 20px;
}
</style>
</head>

<body>

<h2>‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
<input id="code" placeholder="‡πÄ‡∏ä‡πà‡∏ô BRT7K2">
<br>
<button onclick="draw()">‡∏î‡∏π‡∏ú‡∏•‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å</button>

<p id="result"></p>

<script>
// ======================
// üîß Firebase config
// ======================
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
});

const db = firebase.firestore();
const prizes = ["‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥", "‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤", "‡∏£‡πà‡∏°", "‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©"];

async function draw() {
  const code = document.getElementById("code").value.trim();
  const output = document.getElementById("result");

  if (!code) return;

  const ref = db.collection("users").doc(code);
  const snap = await ref.get();

  if (!snap.exists) {
    output.innerText = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    return;
  }

  const data = snap.data();

  // ======================
  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏à‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏î‡∏¥‡∏°
  // ======================
  if (data.used) {
    output.innerText =
      "üéÅ " + data.name + " ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö: " + data.result;
    return;
  }

  // ======================
  // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏à‡∏±‡∏ö ‚Üí ‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  // ======================
  const prize = prizes[Math.floor(Math.random() * prizes.length)];

  await ref.update({
    used: true,
    result: prize
  });

  output.innerText =
    "üéâ " + data.name + " ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö: " + prize;
}
</script>

</body>
</html>
